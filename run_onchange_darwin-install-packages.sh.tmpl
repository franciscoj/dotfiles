#!/bin/sh

{{- if (eq .chezmoi.os "darwin") }}
set -e

brew bundle --file=/dev/stdin <<EOF
{{- range .packages.darwin.tap }}
tap "{{.}}"
{{- end }}
{{- range .packages.darwin.ensure.brew }}
brew "{{.}}"
{{- end }}
{{- range .packages.darwin.ensure.cask }}
cask "{{.}}"
{{- end }}
EOF

echo "Removing..."
{{- range .packages.darwin.remove }}
brew uninstall {{.}}
{{- end }}

{{- else }}
echo "Not macOS, skipping Homebrew package installation."
{{- end }}
